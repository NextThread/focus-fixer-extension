!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){e.exports=o(1)},function(e,t,o){"use strict";o.r(t);var n={facebook:{control:!1,time:0,url:"*://*.facebook.com/"},twitter:{control:!1,time:0,url:"*://*.twitter.com/"},instagram:{control:!1,time:0,url:"*://*.instagram.com/"},youtube:{control:!1,time:0,url:"*://*.youtube.com/"},linkedin:{control:!1,time:0,url:"*://*.linkedin.com/"},codingninjas:{control:!1,time:0,url:"*://*.codingninjas.com/"},geeksforgeeks:{control:!1,time:0,url:"*://*.geeksforgeeks.org/"},atcoder:{control:!1,time:0,url:"*://*.atcoder.com/"},leetcode:{control:!1,time:0,url:"*://*.leetcode.com/"},codechef:{control:!1,time:0,url:"*://*.codechef.com/"},codeforces:{control:!1,time:0,url:"*://*.codeforces.com/"},hackerearth:{control:!1,time:0,url:"*://*.hackerearth.com/"},hackerrank:{control:!1,time:0,url:"*://*.hackerrank.com/"}};const r=chrome.storage.local;var a={async update(e,t){const o=this.getCurrentDate();let n=await this.getData("timer");n=n[o]||{},n[e]?n[e]+=t:n[e]=t,this.save("timer",{[o]:n})},getData:e=>new Promise(t=>{r.get(e,o=>o[e]?t(o[e]):t({}))}),save:(e,t)=>new Promise(o=>{r.set({[e]:t},()=>{o()})}),async initialize(){const e=await this.getData("sites");Object.values(e).length||this.save("sites",n)},getCurrentDate:()=>(new Date).toISOString().substr(0,10)};a.initialize();const i=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],c=["#CC1515","#F23C3C","#F28A8A","#E64AD6","#B31EAD","#BAE29B","#89E540","#6DE733","#2ABA86","#15A862","#A6C6E3","#58B3E7","#1780E1","#9080F2","#6525ED"];function s(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return`${this.getFullYear()}-${s(this.getMonth()+1)}-${s(this.getDate())}T${s(this.getHours())}:${s(this.getMinutes())}:${s(this.getSeconds())}.${(this.getMilliseconds()/1e3).toFixed(3).slice(2,5)}`};var u={getData:e=>a.getData(e),isTabAMatch(e,t){const o=Object.values(t).map(e=>e.url),n=e.split(".");return o.some(e=>n.every(t=>e.includes(t)))},getActiveTab:()=>new Promise(e=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{e(t[0])})}),getCurrentDate:()=>(new Date).toISOString().substr(0,10),end(e){const t=Date.now(),{active:o}=e;if(o.name){const n=this.getCurrentDate(),r=new Date(n+"T00:00:00").getTime(),i=Math.max(r,o.timeStamp),c=parseInt((t-i)/1e3,10);e.data[n]||(e.data={},e.data[n]={});const s=e.data[n][o.name]||0;e.data[n][o.name]=s+c,e.active={},a.update(o.name,c)}},getName(e){try{return new URL(e).hostname.replace("www.","").replace(".com","")}catch(e){return""}},notify(e,t){const o={type:"basic",iconUrl:"images/icon_161.png",title:"FOCUS FIXER",message:e};t&&(o.buttons=[{title:"Close Site"}],o.requireInteraction=!0),chrome.notifications.create(o,()=>{})},saveConfiguration:(e,t)=>a.save(e,t),isTimeExceeded({configuration:e,data:t},o){const n=t[this.getCurrentDate()];return!!(e[o]&&e[o].control&&n&&n[o]>=60*e[o].time)&&(this.notify("Time limit exceeded for "+o),!0)},isTimeframeBlocked({configuration:e},t){const o=new Date,n=i[o.getDay()];if(!(e[t]&&e[t].control&&e[t].days&&e[t].days[n]))return!1;const r=this.getCurrentTime(o);for(let o=0;o<e[t].days[n].length;o+=1){const{from:a,to:i}=e[t].days[n][o];if(a<=r&&i>=r)return this.notify(`You can't use ${t} between ${a} and ${i} on ${n}`),!0}return!1},getSecondsToNextBlock(e){const t=new Date,o=i[t.getDay()];if(!e||!e.days||!e.days[o])return null;const n=e.days[o],r=this.getCurrentTime(t);let a=null;if(n.forEach(e=>{r<e.from&&(a?e.from<a&&(a=e.from):a=e.from)}),a){const e=new Date,o=a.split(":");return e.setHours(o[0],o[1]),(e-t)/1e3}return null},getCurrentTime(e=null){e||(e=new Date);let t=e.getHours(),o=e.getMinutes();return t<10&&(t="0"+t),o<10&&(o="0"+o),`${t}:${o}`},getBarBackgroundColors(e,t){let o=-1;return e.map(e=>t[e]&&t[e].color?t[e].color:(o=(o+1)%c.length,c[o]))}};const l={active:{},configuration:{},data:{}};let m;const d=async()=>{const e=await u.getActiveTab();if(e){const{url:t,id:o}=e,n=u.getName(t);u.isTabAMatch(n,l.configuration)&&(u.isTimeExceeded(l,n)||u.isTimeframeBlocked(l,n)?chrome.tabs.remove(o):l.active.name!==n&&(u.end(l),l.active={name:n,timeStamp:Date.now()},clearTimeout(m),(async(e,t)=>{const{configuration:o}=l;if(o[e]&&o[e].control){const n=u.getCurrentDate(),{data:r}=l;let a=0;r[n]&&r[n][e]&&(a=r[n][e]);const i=60*o[e].time-a,c=u.getSecondsToNextBlock(o[e]);let s=i;c&&c<i&&(s=c),m=setTimeout(()=>{chrome.tabs.remove(t),u.notify("You can no longer be on "+e)},1e3*s)}})(n,o)))}},g=async(e=!1)=>{const t=[u.getData("sites")];let o;e&&(o=u.getCurrentDate(),t.push(u.getData("timer")));const n=await Promise.all(t);[l.configuration]=n,e&&(l.data[o]||(l.data={},l.data[o]=n[1][o]))};g(!0),chrome.tabs.onUpdated.addListener((e,t,o)=>{const{url:n}=o,r=u.getName(n);l.active.name!==r&&d()}),chrome.tabs.onActivated.addListener(()=>{clearTimeout(m),l.active.name&&u.end(l),d()}),chrome.windows.onFocusChanged.addListener(e=>{clearTimeout(m),-1===e?u.end(l):d()}),chrome.notifications.onButtonClicked.addListener((e,t)=>{0===t&&chrome.tabs.query({active:!0,currentWindow:!0},e=>{chrome.tabs.remove(e[0].id)})}),chrome.storage.onChanged.addListener((e,t)=>{e.sites&&"local"===t&&g()})}]);